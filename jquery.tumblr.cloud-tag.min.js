/**
*	Create cloud tag for your tumblr blog
**/$.fn.cloudTag=function(e){var t=$.extend({tumblrSite:location.hostname,showCount:!1,countDelimeterLeft:"(",countDelimeterRight:")",sortBy:"name",autoSize:!1},e),n=this,r=0,i=0,s=function(e){r=e.response.blog.posts;o()},o=function(){var e=0,s=20,o=[];$.ajaxSetup({cache:!1});var a=function(e){var t=e.response.posts;for(var a=0;a<t.length;a++){var f=t[a].tags;for(var l=0;l<f.length;l++){var c=f[l];if(!JSON.stringify(o).match('"'+c+'"')){console.log(c);o.push({name:c,count:1})}else for(var h in o)o[h].name==c&&o[h].count++;i++}}s>=r?$(n).html(u(o)):s+=20};while(e<r){$.ajax({type:"GET",url:"http://api.tumblr.com/v2/blog/"+t.tumblrSite+"/posts",dataType:"jsonp",data:{api_key:t.apiKey,offset:e},success:function(e){a(e)}});e+=20}},u=function(e){t.sortBy=="count"?e.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:e.name<t.name?-1:0}):t.sortBy=="name"&&e.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});var n="",r=0;for(var i=0;i<e.length;i++)r+=e[i].count;for(var i=0;i<e.length;i++){var s=e[i],o=s.name,u=s.count,a="";if(t.autoSize){var f=100/r*u;f<20?a="freq-1":f<40?a="freq-2":f<60?a="freq-3":f<80?a="freq-4":f<100&&(a="freq-5")}var l=t.showCount?" "+t.countDelimeterLeft+u+t.countDelimeterRight:"";n+='<li><a href="/tagged/'+o.replace(/\s+/g,"-")+'" class="'+a+'">'+o+l+"</a></li>"}return n};$.ajaxSetup({cache:!1});$.ajax({type:"GET",url:"http://api.tumblr.com/v2/blog/"+t.tumblrSite+"/info",dataType:"jsonp",data:{api_key:t.apiKey},success:function(e){s(e)}})};